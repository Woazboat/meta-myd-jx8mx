From 1f34f14e4a6b71c76b6523cb94955c2e9930faff Mon Sep 17 00:00:00 2001
From: duxy <568988005@qq.com>
Date: Mon, 17 Jun 2019 15:55:45 +0800
Subject: [PATCH 3/3] [add] configure 1g DDR

---
 board/freescale/imx8mq_evk/lpddr4_timing.c | 40 +++++++++++-----------
 include/configs/imx8mq_evk.h               |  2 +-
 2 files changed, 21 insertions(+), 21 deletions(-)

diff --git a/board/freescale/imx8mq_evk/lpddr4_timing.c b/board/freescale/imx8mq_evk/lpddr4_timing.c
index d9ccb96..8766216 100755
--- a/board/freescale/imx8mq_evk/lpddr4_timing.c
+++ b/board/freescale/imx8mq_evk/lpddr4_timing.c
@@ -14,11 +14,11 @@ struct dram_cfg_param ddr_ddrc_cfg[] = {
 	/** Initialize DDRC registers **/
 	{0x3d400304,0x1},
 	{0x3d400030,0x1},
-	{0x3d400000,0xa3080020},
+	{0x3d400000,0xa1080020},
 	{0x3d400028,0x0},
 	{0x3d400020,0x203},
 	{0x3d400024,0x186a000},
-	{0x3d400064,0x6100e0},
+	{0x3d400064,0x610090},
 	{0x3d4000d0,0xc003061c},
 	{0x3d4000d4,0x9e0000},
 	{0x3d4000dc,0xd4002d},
@@ -34,9 +34,9 @@ struct dram_cfg_param ddr_ddrc_cfg[] = {
 	{0x3d40011c,0x401},
 	{0x3d400130,0x20600},
 	{0x3d400134,0xc100002},
-	{0x3d400138,0xe6},
+	{0x3d400138,0x96},
 	{0x3d400144,0xa00050},
-	{0x3d400180,0xc3200018},
+	{0x3d400180,0x3200018},
 	{0x3d400184,0x28061a8},
 	{0x3d400188,0x0},
 	{0x3d400190,0x497820a},
@@ -50,7 +50,7 @@ struct dram_cfg_param ddr_ddrc_cfg[] = {
 	{0x3d4001c4,0x1},
 	{0x3d4000f4,0x639},
 	{0x3d400108,0x70e1214},
-	{0x3d400200,0x16},
+	{0x3d400200,0x1f},
 	{0x3d40020c,0x0},
 	{0x3d400210,0x1f1f},
 	{0x3d400204,0x80808},
@@ -59,7 +59,7 @@ struct dram_cfg_param ddr_ddrc_cfg[] = {
 	{0x3d402020,0x1},
 	{0x3d402024,0x518b00},
 	{0x3d402050,0x20d040},
-	{0x3d402064,0x14002f},
+	{0x3d402064,0x14001f},
 	{0x3d4020dc,0x940009},
 	{0x3d4020e0,0x310000},
 	{0x3d4020e8,0x66004a},
@@ -74,9 +74,9 @@ struct dram_cfg_param ddr_ddrc_cfg[] = {
 	{0x3d40211c,0x301},
 	{0x3d402130,0x20300},
 	{0x3d402134,0xa100002},
-	{0x3d402138,0x31},
+	{0x3d402138,0x20},
 	{0x3d402144,0x220011},
-	{0x3d402180,0xc0a70006},
+	{0x3d402180,0xa70006},
 	{0x3d402190,0x3858202},
 	{0x3d402194,0x80303},
 	{0x3d4021b4,0x502},
@@ -84,8 +84,8 @@ struct dram_cfg_param ddr_ddrc_cfg[] = {
 	{0x3d400250,0x29001505},
 	{0x3d400254,0x2c},
 	{0x3d40025c,0x5900575b},
-	{0x3d400264,0x90000096},
-	{0x3d40026c,0x1000012c},
+	{0x3d400264,0x9},
+	{0x3d40026c,0x2005574},
 	{0x3d400300,0x16},
 	{0x3d400304,0x0},
 	{0x3d40030c,0x0},
@@ -95,10 +95,10 @@ struct dram_cfg_param ddr_ddrc_cfg[] = {
 	{0x3d400404,0x10f3},
 	{0x3d400408,0x72ff},
 	{0x3d400490,0x1},
-	{0x3d400494,0xe00},
-	{0x3d400498,0x62ffff},
-	{0x3d40049c,0xe00},
-	{0x3d4004a0,0xffff},
+	{0x3d400494,0x1110d00},
+	{0x3d400498,0x620790},
+	{0x3d40049c,0x100001},
+	{0x3d4004a0,0x41f},
 };
 
 /* PHY Initialize Configuration */
@@ -999,7 +999,7 @@ struct dram_cfg_param ddr_fsp0_cfg[] = {
 	{0x54009,0xc8},
 	{0x5400b,0x2},
 	{0x5400d,0x100},
-	{0x54012,0x310},
+	{0x54012,0x110},
 	{0x54019,0x2dd4},
 	{0x5401a,0x31},
 	{0x5401b,0x4a66},
@@ -1011,7 +1011,7 @@ struct dram_cfg_param ddr_fsp0_cfg[] = {
 	{0x54022,0x4a08},
 	{0x54024,0x16},
 	{0x5402b,0x1000},
-	{0x5402c,0x3},
+	{0x5402c,0x1},
 	{0x54032,0xd400},
 	{0x54033,0x312d},
 	{0x54034,0x6600},
@@ -1040,7 +1040,7 @@ struct dram_cfg_param ddr_fsp1_cfg[] = {
 	{0x54009,0xc8},
 	{0x5400b,0x2},
 	{0x5400d,0x100},
-	{0x54012,0x310},
+	{0x54012,0x110},
 	{0x54019,0x994},
 	{0x5401a,0x31},
 	{0x5401b,0x4a66},
@@ -1052,7 +1052,7 @@ struct dram_cfg_param ddr_fsp1_cfg[] = {
 	{0x54022,0x4a08},
 	{0x54024,0x16},
 	{0x5402b,0x1000},
-	{0x5402c,0x3},
+	{0x5402c,0x1},
 	{0x54032,0x9400},
 	{0x54033,0x3109},
 	{0x54034,0x6600},
@@ -1081,7 +1081,7 @@ struct dram_cfg_param ddr_fsp0_2d_cfg[] = {
 	{0x5400b,0x2},
 	{0x5400f,0x100},
 	{0x54010,0x1f7f},
-	{0x54012,0x310},
+	{0x54012,0x110},
 	{0x54019,0x2dd4},
 	{0x5401a,0x31},
 	{0x5401b,0x4a66},
@@ -1093,7 +1093,7 @@ struct dram_cfg_param ddr_fsp0_2d_cfg[] = {
 	{0x54022,0x4a08},
 	{0x54024,0x16},
 	{0x5402b,0x1000},
-	{0x5402c,0x3},
+	{0x5402c,0x1},
 	{0x54032,0xd400},
 	{0x54033,0x312d},
 	{0x54034,0x6600},
diff --git a/include/configs/imx8mq_evk.h b/include/configs/imx8mq_evk.h
index 992b4c4..416e81d 100755
--- a/include/configs/imx8mq_evk.h
+++ b/include/configs/imx8mq_evk.h
@@ -211,7 +211,7 @@
 
 #define CONFIG_SYS_SDRAM_BASE           0x40000000
 #define PHYS_SDRAM                      0x40000000
-#define PHYS_SDRAM_SIZE			0x80000000 /* 2GB DDR */
+#define PHYS_SDRAM_SIZE			0x40000000 /* 1GB DDR */
 #define CONFIG_NR_DRAM_BANKS		1
 
 #define CONFIG_SYS_MEMTEST_START    PHYS_SDRAM
-- 
2.24.1

